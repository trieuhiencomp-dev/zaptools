<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image to Text OCR - Chuy·ªÉn ·∫¢nh Th√†nh Text | ZapTools</title>
    <meta name="description" content="Chuy·ªÉn ·∫£nh th√†nh text mi·ªÖn ph√≠. OCR online h·ªó tr·ª£ ti·∫øng Vi·ªát v√† ti·∫øng Anh. Tr√≠ch xu·∫•t ch·ªØ t·ª´ ·∫£nh nhanh ch√≥ng.">
    <link rel="stylesheet" href="dark-mode.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: white; padding: 1rem; }
        .container { max-width: 1100px; margin: 0 auto; }
        .back-link { display: inline-block; margin-bottom: 1rem; color: white; text-decoration: none; opacity: 0.8; transition: opacity 0.3s; }
        .back-link:hover { opacity: 1; }
        .header { text-align: center; margin-bottom: 2rem; }
        .header h1 { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .header p { font-size: 1.1rem; opacity: 0.9; }
        .tool-container { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-radius: 20px; padding: 2rem; border: 1px solid rgba(255, 255, 255, 0.2); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }

        .upload-section { margin-bottom: 2rem; }
        .upload-area { border: 3px dashed rgba(255,255,255,0.4); border-radius: 15px; padding: 3rem 2rem; text-align: center; cursor: pointer; transition: all 0.3s; background: rgba(255,255,255,0.05); }
        .upload-area:hover { border-color: rgba(255,255,255,0.8); background: rgba(255,255,255,0.1); }
        .upload-area.dragover { border-color: #FF0080; background: rgba(255,0,128,0.1); transform: scale(1.02); }
        .upload-icon { font-size: 3rem; margin-bottom: 1rem; }
        .upload-text { font-size: 1.2rem; margin-bottom: 0.5rem; font-weight: 600; }
        .upload-hint { font-size: 0.9rem; opacity: 0.8; }
        input[type="file"] { display: none; }

        .language-select { margin-bottom: 1.5rem; }
        .language-select label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
        select { width: 100%; padding: 0.75rem; border-radius: 10px; border: 2px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); color: white; font-size: 1rem; }
        select option { background: #764ba2; color: white; }

        .preview-section { display: none; margin-bottom: 2rem; }
        .preview-section.show { display: block; }
        .preview-container { background: rgba(255,255,255,0.08); padding: 1.5rem; border-radius: 15px; }
        .preview-image { max-width: 100%; height: auto; border-radius: 10px; margin-bottom: 1rem; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }

        .btn { padding: 1rem 2rem; background: linear-gradient(135deg, #FF0080 0%, #FF8C00 100%); color: white; border: none; border-radius: 50px; font-size: 1.1rem; font-weight: 700; cursor: pointer; width: 100%; margin: 0.5rem 0; transition: all 0.3s; box-shadow: 0 4px 15px rgba(255,0,128,0.3); }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(255,0,128,0.4); }
        .btn:disabled { background: rgba(255,255,255,0.2); cursor: not-allowed; transform: none; }

        .progress-section { display: none; margin: 1.5rem 0; }
        .progress-section.show { display: block; }
        .progress-bar { width: 100%; height: 30px; background: rgba(255,255,255,0.1); border-radius: 15px; overflow: hidden; position: relative; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #FF0080 0%, #FF8C00 100%); width: 0%; transition: width 0.3s; display: flex; align-items: center; justify-content: center; font-weight: 600; }
        .progress-text { margin-top: 0.5rem; text-align: center; font-size: 0.95rem; opacity: 0.9; }

        .result-section { display: none; margin-top: 2rem; }
        .result-section.show { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .result-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .result-header h3 { font-size: 1.2rem; }
        .char-count { font-size: 0.9rem; opacity: 0.8; }
        .result-text { background: rgba(255,255,255,0.08); padding: 1.5rem; border-radius: 10px; min-height: 200px; max-height: 400px; overflow-y: auto; line-height: 1.8; border: 2px solid rgba(255,255,255,0.1); white-space: pre-wrap; word-wrap: break-word; }
        .result-text::-webkit-scrollbar { width: 8px; }
        .result-text::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 10px; }
        .result-text::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 10px; }

        .action-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem; }
        .copy-btn { background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); }
        .clear-btn { background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%); }

        .tips-section { background: rgba(255,255,255,0.08); padding: 1.5rem; border-radius: 10px; margin-top: 2rem; }
        .tips-section h3 { margin-bottom: 1rem; }
        .tips-section ul { list-style: none; padding: 0; }
        .tips-section li { padding: 0.5rem 0; padding-left: 1.5rem; position: relative; }
        .tips-section li:before { content: "‚úì"; position: absolute; left: 0; color: #4CAF50; font-weight: bold; }

        @media (max-width: 768px) {
            .header h1 { font-size: 2rem; }
            .tool-container { padding: 1.5rem; }
            .action-buttons { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="Index.html" class="back-link">‚Üê V·ªÅ trang ch·ªß ZapTools</a>
        <div class="header">
            <h1>üì∏ Image to Text (OCR)</h1>
            <p>Chuy·ªÉn ·∫£nh th√†nh text v·ªõi c√¥ng ngh·ªá OCR - Mi·ªÖn ph√≠!</p>
        </div>
        <div class="tool-container">
            <!-- Language Selection -->
            <div class="language-select">
                <label>üåê Ch·ªçn ng√¥n ng·ªØ:</label>
                <select id="language">
                    <option value="vie">Ti·∫øng Vi·ªát</option>
                    <option value="eng" selected>English (Ti·∫øng Anh)</option>
                    <option value="vie+eng">Ti·∫øng Vi·ªát + English</option>
                </select>
            </div>

            <!-- Upload Area -->
            <div class="upload-section">
                <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-icon">üì§</div>
                    <div class="upload-text">Click ƒë·ªÉ ch·ªçn ·∫£nh ho·∫∑c k√©o th·∫£ v√†o ƒë√¢y</div>
                    <div class="upload-hint">H·ªó tr·ª£: JPG, PNG, GIF, WebP (t·ªëi ƒëa 10MB)</div>
                </div>
                <input type="file" id="fileInput" accept="image/*" onchange="handleFileSelect(event)">
            </div>

            <!-- Preview Section -->
            <div class="preview-section" id="previewSection">
                <div class="preview-container">
                    <img id="previewImage" class="preview-image" alt="Preview">
                </div>
                <button class="btn" id="processBtn" onclick="processImage()">üîç Tr√≠ch xu·∫•t text t·ª´ ·∫£nh</button>
            </div>

            <!-- Progress Section -->
            <div class="progress-section" id="progressSection">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill">0%</div>
                </div>
                <div class="progress-text" id="progressText">ƒêang kh·ªüi t·∫°o OCR engine...</div>
            </div>

            <!-- Result Section -->
            <div class="result-section" id="resultSection">
                <div class="result-header">
                    <h3>üìù K·∫øt qu·∫£:</h3>
                    <span class="char-count" id="charCount">0 k√Ω t·ª±</span>
                </div>
                <div class="result-text" id="resultText"></div>
                <div class="action-buttons">
                    <button class="btn copy-btn" onclick="copyResult()">üìã Copy Text</button>
                    <button class="btn clear-btn" onclick="clearAll()">üîÑ L√†m l·∫°i</button>
                </div>
            </div>

            <!-- Tips Section -->
            <div class="tips-section">
                <h3>üí° M·∫πo ƒë·ªÉ c√≥ k·∫øt qu·∫£ t·ªët nh·∫•t:</h3>
                <ul>
                    <li>S·ª≠ d·ª•ng ·∫£nh c√≥ ƒë·ªô ph√¢n gi·∫£i cao v√† r√µ n√©t</li>
                    <li>ƒê·∫£m b·∫£o ch·ªØ trong ·∫£nh kh√¥ng b·ªã m·ªù ho·∫∑c nghi√™ng qu√°</li>
                    <li>N·ªÅn ·∫£nh n√™n ƒë∆°n gi·∫£n, t∆∞∆°ng ph·∫£n v·ªõi ch·ªØ</li>
                    <li>Ch·ªçn ƒë√∫ng ng√¥n ng·ªØ ƒë·ªÉ tƒÉng ƒë·ªô ch√≠nh x√°c</li>
                    <li>OCR ho·∫°t ƒë·ªông ho√†n to√†n tr√™n tr√¨nh duy·ªát, kh√¥ng upload ·∫£nh l√™n server</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Tesseract.js CDN -->
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
    <script src="dark-mode.js"></script>
    <script>
        let selectedFile = null;
        let worker = null;

        // Drag and drop handlers
        const uploadArea = document.getElementById('uploadArea');

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            // Validate file type
            if (!file.type.startsWith('image/')) {
                alert('‚ùå Vui l√≤ng ch·ªçn file ·∫£nh!');
                return;
            }

            // Validate file size (max 10MB)
            if (file.size > 10 * 1024 * 1024) {
                alert('‚ùå File qu√° l·ªõn! Vui l√≤ng ch·ªçn ·∫£nh d∆∞·ªõi 10MB.');
                return;
            }

            selectedFile = file;

            // Show preview
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('previewImage').src = e.target.result;
                document.getElementById('previewSection').classList.add('show');
                document.getElementById('resultSection').classList.remove('show');
            };
            reader.readAsDataURL(file);
        }

        async function processImage() {
            if (!selectedFile) {
                alert('‚ùå Vui l√≤ng ch·ªçn ·∫£nh tr∆∞·ªõc!');
                return;
            }

            const language = document.getElementById('language').value;
            const progressSection = document.getElementById('progressSection');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const resultSection = document.getElementById('resultSection');
            const processBtn = document.getElementById('processBtn');

            // Show progress
            progressSection.classList.add('show');
            resultSection.classList.remove('show');
            processBtn.disabled = true;

            try {
                // Create worker if not exists
                if (!worker) {
                    progressText.textContent = 'ƒêang t·∫£i OCR engine...';
                    worker = await Tesseract.createWorker(language, 1, {
                        logger: (m) => {
                            if (m.status === 'loading tesseract core') {
                                progressFill.style.width = '20%';
                                progressFill.textContent = '20%';
                                progressText.textContent = 'ƒêang t·∫£i Tesseract core...';
                            } else if (m.status === 'initializing tesseract') {
                                progressFill.style.width = '40%';
                                progressFill.textContent = '40%';
                                progressText.textContent = 'ƒêang kh·ªüi t·∫°o...';
                            } else if (m.status === 'loading language traineddata') {
                                progressFill.style.width = '60%';
                                progressFill.textContent = '60%';
                                progressText.textContent = 'ƒêang t·∫£i ng√¥n ng·ªØ...';
                            } else if (m.status === 'initializing api') {
                                progressFill.style.width = '80%';
                                progressFill.textContent = '80%';
                                progressText.textContent = 'ƒêang kh·ªüi t·∫°o API...';
                            } else if (m.status === 'recognizing text') {
                                const percent = Math.round(m.progress * 100);
                                progressFill.style.width = percent + '%';
                                progressFill.textContent = percent + '%';
                                progressText.textContent = 'ƒêang nh·∫≠n di·ªán text...';
                            }
                        }
                    });
                } else {
                    // If worker exists, just load the language
                    await worker.loadLanguage(language);
                    await worker.initialize(language);
                }

                progressText.textContent = 'ƒêang x·ª≠ l√Ω ·∫£nh...';

                // Perform OCR
                const { data: { text } } = await worker.recognize(selectedFile);

                // Show result
                progressFill.style.width = '100%';
                progressFill.textContent = '100%';
                progressText.textContent = '‚úÖ Ho√†n th√†nh!';

                setTimeout(() => {
                    progressSection.classList.remove('show');
                    displayResult(text);
                }, 500);

            } catch (error) {
                console.error('OCR Error:', error);
                progressSection.classList.remove('show');
                alert('‚ùå C√≥ l·ªói x·∫£y ra khi x·ª≠ l√Ω ·∫£nh. Vui l√≤ng th·ª≠ l·∫°i!');
            } finally {
                processBtn.disabled = false;
            }
        }

        function displayResult(text) {
            const resultSection = document.getElementById('resultSection');
            const resultText = document.getElementById('resultText');
            const charCount = document.getElementById('charCount');

            resultText.textContent = text || '(Kh√¥ng t√¨m th·∫•y text trong ·∫£nh)';
            charCount.textContent = text.length.toLocaleString() + ' k√Ω t·ª±';
            resultSection.classList.add('show');
        }

        function copyResult() {
            const text = document.getElementById('resultText').textContent;
            navigator.clipboard.writeText(text).then(() => {
                const btn = event.target;
                const originalText = btn.innerHTML;
                btn.innerHTML = '‚úÖ ƒê√£ copy!';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                }, 2000);
            }).catch(err => {
                alert('‚ùå Kh√¥ng th·ªÉ copy. Vui l√≤ng ch·ªçn text v√† copy th·ªß c√¥ng.');
            });
        }

        function clearAll() {
            selectedFile = null;
            document.getElementById('fileInput').value = '';
            document.getElementById('previewSection').classList.remove('show');
            document.getElementById('resultSection').classList.remove('show');
            document.getElementById('progressSection').classList.remove('show');
        }

        // Cleanup worker on page unload
        window.addEventListener('beforeunload', async () => {
            if (worker) {
                await worker.terminate();
            }
        });
    </script>
</body>
</html>
