<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="google-adsense-account" content="ca-pub-6389544196145251">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2QEQX2T9JX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-2QEQX2T9JX');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to Excel Converter Free 2025 - Convert PDF to XLSX Online | ZapTools</title>
    <meta name="description" content="Convert PDF to Excel spreadsheets for free! Extract tables from PDF to XLSX. No signup required. Accurate data conversion, editable Excel files. Free online PDF to Excel converter 2025.">
    <meta name="keywords" content="pdf to excel, pdf to xlsx, convert pdf to excel, pdf to spreadsheet, free pdf to excel converter, pdf excel converter online 2025">
    <meta name="author" content="ZapTools">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <link rel="canonical" href="https://zaptools.org/PDFtoExcel.html">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://zaptools.org/PDFtoExcel.html">
    <meta property="og:title" content="PDF to Excel Converter Free 2025 - Convert PDF to XLSX Online | ZapTools">
    <meta property="og:description" content="Convert PDF to Excel spreadsheets for free! Extract tables from PDF to XLSX. No signup required. Accurate data conversion.">
    <meta property="og:image" content="https://zaptools.org/og-images/og-image-PDFtoExcel.png">
    <meta property="og:site_name" content="ZapTools">
    <meta property="og:locale" content="en_US">
    <meta property="og:locale:alternate" content="vi_VN">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://zaptools.org/PDFtoExcel.html">
    <meta name="twitter:title" content="PDF to Excel Converter Free 2025 - Convert PDF to XLSX Online | ZapTools">
    <meta name="twitter:description" content="Convert PDF to Excel spreadsheets for free! Extract tables from PDF to XLSX. No signup required.">
    <meta name="twitter:image" content="https://zaptools.org/og-images/og-image-PDFtoExcel.png">

    <meta name="theme-color" content="#667eea">
    <link rel="alternate" hreflang="en" href="https://zaptools.org/PDFtoExcel.html">
    <link rel="alternate" hreflang="vi" href="https://zaptools.org/PDFtoExcel.html">
    <link rel="alternate" hreflang="x-default" href="https://zaptools.org/PDFtoExcel.html">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Free PDF to Excel Converter Online",
      "url": "https://zaptools.org/PDFtoExcel.html",
      "description": "Convert PDF to Excel (XLSX) online for free. Extract tables from PDF, convert to spreadsheet!",
      "applicationCategory": "UtilitiesApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": ["PDF to Excel", "PDF to XLSX", "Table Extraction"]
    }
    </script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6389544196145251" crossorigin="anonymous"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: #333; line-height: 1.6; }
        .zaptools-header { position: fixed; top: 0; left: 0; right: 0; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); padding: 1rem 2rem; box-shadow: 0 2px 10px rgba(0,0,0,0.1); z-index: 1000; display: flex; justify-content: space-between; align-items: center; }
        .logo-section { display: flex; align-items: center; gap: 10px; }
        .zaptools-logo { font-size: 2rem; animation: bounce 2s ease-in-out infinite; filter: drop-shadow(0 4px 10px rgba(102, 126, 234, 0.4)); }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .logo-text { font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .nav-links { display: flex; gap: 2rem; align-items: center; }
        .nav-links a { color: #667eea; text-decoration: none; font-weight: 600; transition: color 0.3s; }
        .nav-links a:hover { color: #764ba2; }
        #langSwitcher { padding: 0.5rem 1rem; border-radius: 20px; border: 2px solid #667eea; background: white; color: #667eea; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        #langSwitcher:hover { background: #667eea; color: white; }
        .tool-section { background: white; border-radius: 20px; padding: 3rem; box-shadow: 0 20px 60px rgba(0,0,0,0.15); margin-bottom: 3rem; }
        .tool-section h1 { color: #667eea; font-size: 2.5rem; margin-bottom: 1rem; text-align: center; }
        .tool-section .subtitle { text-align: center; color: #666; font-size: 1.1rem; margin-bottom: 2rem; }
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; font-weight: 600; color: #333; margin-bottom: 0.5rem; }
        .form-group input[type="file"] { width: 100%; padding: 1rem; border: 2px dashed #667eea; border-radius: 10px; background: #f8f9ff; cursor: pointer; transition: all 0.3s; }
        .form-group input[type="file"]:hover { border-color: #764ba2; background: #f0f0ff; }
        .tool-btn { width: 100%; padding: 1rem 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; margin-top: 1rem; }
        .tool-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3); }
        .tool-btn:active { transform: translateY(0); }
        .back-btn { background: linear-gradient(135deg, #818cf8 0%, #6366f1 100%); margin-top: 2rem; }
        .instructions { background: linear-gradient(135deg, #f8f9ff 0%, #e8eaff 100%); padding: 1.5rem; border-radius: 10px; margin-top: 1.5rem; border-left: 4px solid #667eea; }
        .instructions strong { color: #667eea; font-size: 1.1rem; }
        .instructions ul { margin: 1rem 0 0 1.5rem; line-height: 2; }
        .instructions li { color: #555; }
        #result { margin-top: 1.5rem; padding: 1rem; border-radius: 10px; text-align: center; font-weight: 600; display: none; }
        #result.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; display: block; }
        #result.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; display: block; }
        #result.info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; display: block; }
        .content-section { background: white; border-radius: 20px; padding: 3rem; box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 3rem; }
        .content-section h2 { color: #667eea; font-size: 2rem; margin-bottom: 1.5rem; border-bottom: 3px solid #667eea; padding-bottom: 0.5rem; }
        .content-section h3 { color: #764ba2; font-size: 1.5rem; margin-top: 2rem; margin-bottom: 1rem; }
        .content-section p { color: #555; margin-bottom: 1rem; text-align: justify; }
        .content-section ul, .content-section ol { margin: 1rem 0 1rem 2rem; color: #555; }
        .content-section li { margin-bottom: 0.5rem; line-height: 1.8; }
        .feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; margin: 2rem 0; }
        .feature-card { background: linear-gradient(135deg, #f8f9ff 0%, #e8eaff 100%); padding: 2rem; border-radius: 15px; text-align: center; transition: transform 0.3s, box-shadow 0.3s; border: 2px solid transparent; }
        .feature-card:hover { transform: translateY(-5px); box-shadow: 0 15px 40px rgba(102, 126, 234, 0.2); border-color: #667eea; }
        .feature-icon { font-size: 3rem; margin-bottom: 1rem; }
        .feature-card h3 { color: #667eea; margin: 0 0 1rem 0; }
        .feature-card p { color: #666; text-align: center; }
        .use-case { background: #f8f9ff; padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem; border-left: 4px solid #764ba2; }
        .use-case h4 { color: #764ba2; margin-bottom: 0.5rem; }
        .use-case p { color: #555; margin: 0; }
        .faq-item { background: #f8f9ff; padding: 1.5rem; border-radius: 10px; margin-bottom: 1rem; cursor: pointer; transition: all 0.3s; }
        .faq-item:hover { background: #e8eaff; transform: translateX(5px); }
        .faq-question { color: #667eea; font-weight: 600; font-size: 1.1rem; margin-bottom: 0.5rem; }
        .faq-answer { color: #555; margin: 0; line-height: 1.8; }
        .tips-box { background: linear-gradient(135deg, #fff7e6 0%, #ffe8cc 100%); padding: 1.5rem; border-radius: 10px; border-left: 4px solid #ff9800; margin: 2rem 0; }
        .tips-box h4 { color: #ff9800; margin-bottom: 1rem; }
        .tips-box ul { margin: 0 0 0 1.5rem; }
        .tips-box li { color: #666; }
        .ad-container { margin: 2rem auto; padding: 1rem; text-align: center; background: rgba(255,255,255,0.5); border-radius: 10px; }
        .ad-label { font-size: 0.7rem; color: #999; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 1px; }
        .page-wrapper { display: flex; max-width: 1400px; margin: 100px auto 2rem; gap: 2rem; padding: 0 1rem; }
        .sidebar-ad { width: 160px; position: sticky; top: 120px; height: fit-content; }
        .main-content { flex: 1; min-width: 0; }
        @media (max-width: 1024px) { .sidebar-ad { display: none; } .page-wrapper { display: block; margin-top: 100px; } .nav-links { display: none; } }
        @media (max-width: 768px) { .zaptools-header { padding: 1rem; } .logo-text { font-size: 1.2rem; } .zaptools-logo { font-size: 1.5rem; } .tool-section, .content-section { padding: 1.5rem; } .tool-section h1 { font-size: 1.8rem; } .content-section h2 { font-size: 1.5rem; } .feature-grid { grid-template-columns: 1fr; } }
        .file-history-widget { position: fixed; bottom: 20px; right: 20px; width: 300px; background: white; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); z-index: 999; transition: all 0.3s; }
        .file-history-widget.collapsed { width: 60px; height: 60px; }
        .history-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1rem; border-radius: 15px 15px 0 0; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .file-history-widget.collapsed .history-header { border-radius: 15px; justify-content: center; }
        .history-title { display: flex; align-items: center; gap: 0.5rem; font-weight: 600; }
        .file-history-widget.collapsed .history-title span:last-child { display: none; }
        .history-toggle { transition: transform 0.3s; }
        .file-history-widget.collapsed .history-toggle { transform: rotate(-90deg); }
        .history-content { max-height: 300px; overflow-y: auto; padding: 1rem; }
        .file-history-widget.collapsed .history-content { display: none; }
        .history-empty { text-align: center; color: #999; padding: 2rem 0; }
    </style>
</head>
<body>
    <div class="zaptools-header">
        <div class="logo-section">
            <span class="zaptools-logo">‚ö°</span>
            <span class="logo-text">ZapTools</span>
        </div>
        <div class="nav-links">
            <a href="Index.html">Home</a>
            <a href="pdf-tools.html">PDF Tools</a>
            <a href="blog-kinh-nghiem-hay.html">Blog</a>
            <select id="langSwitcher">
                <option value="vi">üáªüá≥ Ti·∫øng Vi·ªát</option>
                <option value="en">üá¨üáß English</option>
            </select>
        </div>
    </div>

    <div class="page-wrapper">
        <div class="sidebar-ad">
            <div class="ad-container">
                <div class="ad-label">Ad</div>
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6389544196145251" data-ad-slot="3131107512" data-ad-format="vertical"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>
        </div>

        <div class="main-content">
            <div class="tool-section">
                <h1 id="title">PDF to Excel Free - Convert PDF Tables to Spreadsheets</h1>
                <p class="subtitle" id="subtitle">Extract tables from PDFs and convert to editable Excel files. Fast, accurate, and completely free!</p>

                <form id="pdfForm">
                    <div class="form-group">
                        <label id="fileLabel" for="pdfFile">üìÑ Select PDF File:</label>
                        <input type="file" id="pdfFile" name="pdfFile" accept="application/pdf" required>
                    </div>

                    <div class="form-group" id="ocrOptions" style="display: none;">
                        <label id="ocrLangLabel" for="ocrLanguage">üîç PDF scan detected! Choose OCR language:</label>
                        <select id="ocrLanguage">
                            <option value="eng">üá¨üáß English</option>
                            <option value="vie">üáªüá≥ Ti·∫øng Vi·ªát</option>
                            <option value="vie+eng">üåç Vietnamese + English</option>
                        </select>
                    </div>

                    <button type="submit" class="tool-btn" id="convertBtn">üìä Convert to Excel Now</button>
                    <button type="button" class="tool-btn" id="ocrBtn" style="display: none; background: linear-gradient(135deg, #ff9800 0%, #ff5722 100%);">üîç OCR First, Then Convert</button>
                </form>

                <div class="instructions">
                    <strong id="instructionsTitle">üìã H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng:</strong>
                    <ul id="instructionsList">
                        <li><strong>‚≠ê Khuy√™n d√πng cho PDF ph·ª©c t·∫°p:</strong> M·ªü b·∫±ng <a href="#wordGuideDetail" style="color: #667eea; text-decoration: underline; font-weight: bold;">Microsoft Word (2016+)</a> ‚Üí Copy b·∫£ng ‚Üí Paste v√†o Excel (ƒê·ªô ch√≠nh x√°c 95-99%)</li>
                        <li><strong>PDF ƒë∆°n gi·∫£n:</strong> Tool n√†y t·ª± ƒë·ªông chuy·ªÉn PDF text sang Excel</li>
                        <li><strong>PDF scan:</strong> Tool s·∫Ω t·ª± ƒë·ªông ph√°t hi·ªán v√† b·∫≠t OCR (Ti·∫øng Vi·ªát, English - gi·ªõi h·∫°n 5 trang)</li>
                        <li><strong>‚ö†Ô∏è L∆∞u √Ω:</strong> PDF c√≥ b·∫£ng ph·ª©c t·∫°p (merge cells, nhi·ªÅu c·ªôt) ‚Üí K·∫øt qu·∫£ c√≥ th·ªÉ sai format ‚Üí <a href="#wordGuideDetail" style="color: #667eea; text-decoration: underline;">Xem h∆∞·ªõng d·∫´n d√πng Word b√™n d∆∞·ªõi</a></li>
                        <li>K√≠ch th∆∞·ªõc: <strong>50MB</strong> | S·ªë trang: <strong>50 trang</strong> (text) / <strong>5 trang</strong> (OCR)</li>
                    </ul>
                </div>

                <div id="result"></div>
                <button class="tool-btn back-btn" onclick="window.location.href='pdf-tools.html'">‚Üê Back to PDF Tools</button>
            </div>

            <div class="ad-container">
                <div class="ad-label">Advertisement</div>
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6389544196145251" data-ad-slot="3131107512" data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>

            <div class="content-section">
                <h2>üöÄ Why Choose ZapTools PDF to Excel?</h2>
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">üìä</div>
                        <h3>Accurate Conversion</h3>
                        <p>Preserve table structure and data formatting perfectly</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üîí</div>
                        <h3>100% Secure</h3>
                        <p>Client-side processing. Your files never leave your device</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üíØ</div>
                        <h3>Completely Free</h3>
                        <p>No subscriptions, no hidden fees. Unlimited conversions</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">‚ú®</div>
                        <h3>Editable Output</h3>
                        <p>Get fully editable XLSX files ready for analysis</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üì±</div>
                        <h3>Works Everywhere</h3>
                        <p>Desktop, tablet, or mobile - convert on any device</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">‚ö°</div>
                        <h3>Lightning Fast</h3>
                        <p>Convert PDFs to Excel in seconds</p>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <h2>üìñ H∆∞·ªõng D·∫´n Chuy·ªÉn PDF sang Excel</h2>
                <ol>
                    <li><strong>T·∫£i PDF l√™n</strong> - Ch·ªçn file PDF c√≥ b·∫£ng d·ªØ li·ªáu</li>
                    <li><strong>Nh·∫•n Convert</strong> - Qu√° tr√¨nh x·ª≠ l√Ω di·ªÖn ra ngay trong tr√¨nh duy·ªát</li>
                    <li><strong>T·∫£i Excel xu·ªëng</strong> - Nh·∫≠n file XLSX c√≥ th·ªÉ ch·ªânh s·ª≠a</li>
                    <li><strong>Ch·ªânh s·ª≠a & Ph√¢n t√≠ch</strong> - M·ªü b·∫±ng Excel, Google Sheets ho·∫∑c ·ª©ng d·ª•ng b·∫£ng t√≠nh</li>
                </ol>

                <div class="tips-box">
                    <h4>üí° M·∫πo Chuy·ªÉn ƒê·ªïi Hi·ªáu Qu·∫£</h4>
                    <ul>
                        <li>PDF c√≥ c·∫•u tr√∫c b·∫£ng r√µ r√†ng s·∫Ω chuy·ªÉn ƒë·ªïi t·ªët nh·∫•t</li>
                        <li>B·∫£ng c√≥ vi·ªÅn ho·∫∑c ƒë∆∞·ªùng k·∫ª r√µ r√†ng cho k·∫øt qu·∫£ t·ªët h∆°n</li>
                        <li>PDF nhi·ªÅu trang s·∫Ω t·∫°o nhi·ªÅu sheet Excel t∆∞∆°ng ·ª©ng</li>
                        <li>Ki·ªÉm tra l·∫°i d·ªØ li·ªáu sau khi chuy·ªÉn ƒë·ªïi ƒë·ªÉ ƒë·∫£m b·∫£o ch√≠nh x√°c</li>
                    </ul>
                </div>

                <div class="tips-box" id="wordGuideSection" style="background: linear-gradient(135deg, #fff4e6 0%, #ffe8cc 100%); border-left: 4px solid #ff9800;">
                    <h4 style="color: #ff9800;">‚ö†Ô∏è PDF Ph·ª©c T·∫°p? K·∫øt Qu·∫£ Kh√¥ng ƒê√∫ng Format?</h4>
                    <p style="margin-bottom: 1rem; font-weight: 600;">N·∫øu PDF c√≥ b·∫£ng ph·ª©c t·∫°p (nhi·ªÅu c·ªôt, merged cells, layout ph·ª©c t·∫°p) v√† tool n√†y kh√¥ng cho k·∫øt qu·∫£ t·ªët, h√£y d√πng <strong>Microsoft Word</strong> (MI·ªÑN PH√ç, T·ªët nh·∫•t!):</p>

                    <h4 id="wordGuideDetail" style="color: #ff9800; font-size: 1rem;">üìù H∆∞·ªõng D·∫´n Chi Ti·∫øt - D√πng Microsoft Word:</h4>
                    <ol style="margin: 1rem 0 1rem 1.5rem; line-height: 2;">
                        <li><strong>M·ªü PDF b·∫±ng Word:</strong>
                            <ul style="margin: 0.5rem 0 0 1rem;">
                                <li>Chu·ªôt ph·∫£i v√†o file PDF ‚Üí M·ªü b·∫±ng ‚Üí Microsoft Word (2016 tr·ªü l√™n)</li>
                                <li>Ho·∫∑c: M·ªü Word ‚Üí File ‚Üí Open ‚Üí Ch·ªçn file PDF</li>
                                <li>Word s·∫Ω h·ªèi "convert PDF to Word" ‚Üí Nh·∫•n <strong>OK</strong></li>
                            </ul>
                        </li>
                        <li><strong>Ch·ªù Word convert:</strong> Word s·∫Ω t·ª± ƒë·ªông convert PDF th√†nh Word format (gi·ªØ nguy√™n b·∫£ng + format)</li>
                        <li><strong>Copy b·∫£ng:</strong>
                            <ul style="margin: 0.5rem 0 0 1rem;">
                                <li>Click v√†o b·∫£ng ‚Üí Ch·ªçn to√†n b·ªô b·∫£ng (Ctrl+A ho·∫∑c drag chu·ªôt)</li>
                                <li>Copy (Ctrl+C)</li>
                            </ul>
                        </li>
                        <li><strong>Paste v√†o Excel:</strong>
                            <ul style="margin: 0.5rem 0 0 1rem;">
                                <li>M·ªü Excel m·ªõi</li>
                                <li>Paste (Ctrl+V)</li>
                                <li>B·∫£ng s·∫Ω gi·ªØ nguy√™n format, c·ªôt, h√†ng!</li>
                            </ul>
                        </li>
                        <li><strong>Ch·ªânh s·ª≠a:</strong> Format l·∫°i m·ªôt ch√∫t (ƒë·ªô r·ªông c·ªôt, merge cells) l√† ho√†n t·∫•t!</li>
                    </ol>

                    <h4 style="color: #ff9800; font-size: 1rem; margin-top: 1.5rem;">‚úÖ ∆Øu ƒêi·ªÉm C·ªßa C√°ch N√†y:</h4>
                    <ul>
                        <li>‚úÖ <strong>Mi·ªÖn ph√≠ 100%</strong> (n·∫øu c√≥ Word 2016+)</li>
                        <li>‚úÖ <strong>ƒê·ªô ch√≠nh x√°c 95-99%</strong> - gi·ªØ nguy√™n c·∫•u tr√∫c b·∫£ng</li>
                        <li>‚úÖ <strong>Gi·ªØ format:</strong> merged cells, borders, colors</li>
                        <li>‚úÖ <strong>Nhanh ch√≥ng:</strong> 1-2 ph√∫t cho 1 file</li>
                        <li>‚úÖ <strong>Kh√¥ng c·∫ßn internet</strong></li>
                    </ul>

                    <h4 style="color: #ff9800; font-size: 1rem; margin-top: 1.5rem;">üÜö So S√°nh C√°c C√¥ng C·ª•:</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 0.5rem;">
                        <tr style="background: #fff; border-bottom: 2px solid #ff9800;">
                            <th style="padding: 0.5rem; text-align: left; color: #ff9800;">C√¥ng c·ª•</th>
                            <th style="padding: 0.5rem; text-align: center; color: #ff9800;">ƒê·ªô ch√≠nh x√°c</th>
                            <th style="padding: 0.5rem; text-align: center; color: #ff9800;">Gi√°</th>
                            <th style="padding: 0.5rem; text-align: center; color: #ff9800;">D·ªÖ d√πng</th>
                        </tr>
                        <tr style="background: #fff; border-bottom: 1px solid #eee;">
                            <td style="padding: 0.5rem;"><strong>Microsoft Word</strong></td>
                            <td style="padding: 0.5rem; text-align: center;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                            <td style="padding: 0.5rem; text-align: center;">Mi·ªÖn ph√≠*</td>
                            <td style="padding: 0.5rem; text-align: center;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                        </tr>
                        <tr style="background: #fff; border-bottom: 1px solid #eee;">
                            <td style="padding: 0.5rem;">Adobe Acrobat Pro</td>
                            <td style="padding: 0.5rem; text-align: center;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                            <td style="padding: 0.5rem; text-align: center;">Tr·∫£ ph√≠</td>
                            <td style="padding: 0.5rem; text-align: center;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                        </tr>
                        <tr style="background: #fff; border-bottom: 1px solid #eee;">
                            <td style="padding: 0.5rem;">ZapTools (tool n√†y)</td>
                            <td style="padding: 0.5rem; text-align: center;">‚≠ê‚≠ê‚≠ê</td>
                            <td style="padding: 0.5rem; text-align: center;">Mi·ªÖn ph√≠</td>
                            <td style="padding: 0.5rem; text-align: center;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                        </tr>
                        <tr style="background: #fff;">
                            <td style="padding: 0.5rem;">Google Docs OCR</td>
                            <td style="padding: 0.5rem; text-align: center;">‚≠ê‚≠ê‚≠ê</td>
                            <td style="padding: 0.5rem; text-align: center;">Mi·ªÖn ph√≠</td>
                            <td style="padding: 0.5rem; text-align: center;">‚≠ê‚≠ê‚≠ê</td>
                        </tr>
                    </table>
                    <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">* Mi·ªÖn ph√≠ n·∫øu ƒë√£ c√≥ Word 2016 tr·ªü l√™n</p>
                </div>

                <div class="tips-box" style="background: linear-gradient(135deg, #e6f7ff 0%, #ccedff 100%); border-left: 4px solid #1890ff;">
                    <h4 style="color: #1890ff;">üîç OCR T√≠ch H·ª£p - Cho PDF Scan</h4>
                    <p style="margin-bottom: 1rem;">Tool n√†y c√≥ OCR t√≠ch h·ª£p s·∫µn cho PDF scan (kh√¥ng c√≥ text):</p>
                    <ul>
                        <li><strong>T·ª± ƒë·ªông ph√°t hi·ªán:</strong> Khi ch·ªçn PDF scan, tool s·∫Ω t·ª± ƒë·ªông hi·ªán n√∫t OCR</li>
                        <li><strong>Ch·ªçn ng√¥n ng·ªØ:</strong> Ti·∫øng Vi·ªát, English ho·∫∑c c·∫£ hai</li>
                        <li><strong>Gi·ªõi h·∫°n:</strong> 5 trang ƒë·∫ßu ti√™n (m·ªói trang ~10-30 gi√¢y)</li>
                    </ul>
                    <p style="margin-top: 1rem;"><strong>‚ö†Ô∏è L∆∞u √Ω:</strong> OCR browser kh√¥ng ho√†n h·∫£o v·ªõi b·∫£ng ph·ª©c t·∫°p. D√πng Word nh∆∞ h∆∞·ªõng d·∫´n b√™n tr√™n ƒë·ªÉ ƒë∆∞·ª£c k·∫øt qu·∫£ t·ªët nh·∫•t!</p>
                </div>
            </div>

            <div class="content-section">
                <h2>üíº Common Use Cases</h2>
                <div class="use-case">
                    <h4>üìä Financial Reports</h4>
                    <p>Extract financial tables from annual reports, balance sheets, and income statements for analysis.</p>
                </div>
                <div class="use-case">
                    <h4>üìà Data Analysis</h4>
                    <p>Convert statistical tables, survey results, and research data into Excel for processing.</p>
                </div>
                <div class="use-case">
                    <h4>üìã Invoice Processing</h4>
                    <p>Extract line items from PDF invoices into spreadsheets for accounting and bookkeeping.</p>
                </div>
                <div class="use-case">
                    <h4>üìö Academic Research</h4>
                    <p>Convert research data tables from PDF papers into analyzable Excel format.</p>
                </div>
                <div class="use-case">
                    <h4>üíº Business Reports</h4>
                    <p>Extract sales data, performance metrics, and KPI tables for further analysis.</p>
                </div>
                <div class="use-case">
                    <h4>üìä Price Lists</h4>
                    <p>Convert product catalogs and price lists from PDF to editable Excel spreadsheets.</p>
                </div>
            </div>

            <div class="ad-container">
                <div class="ad-label">Advertisement</div>
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6389544196145251" data-ad-slot="3131107512" data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>

            <div class="content-section">
                <h2>üéì Advanced Tips</h2>
                <h3>1. Preparing PDFs for Best Results</h3>
                <ul>
                    <li>Ensure tables have clear borders</li>
                    <li>Remove unnecessary headers/footers</li>
                    <li>Convert multi-column layouts to single column if possible</li>
                    <li>For scanned PDFs, apply OCR first for text recognition</li>
                </ul>

                <h3>2. Working with Complex Tables</h3>
                <ul>
                    <li>Merged cells may need manual adjustment</li>
                    <li>Nested tables might require splitting</li>
                    <li>Color-coded data is preserved in Excel</li>
                    <li>Formulas in PDF are converted to static values</li>
                </ul>

                <h3>3. Post-Conversion Editing</h3>
                <ul>
                    <li>Verify data types (numbers, dates, text)</li>
                    <li>Adjust column widths for readability</li>
                    <li>Add formulas for calculations</li>
                    <li>Format cells as needed (currency, percentages, etc.)</li>
                </ul>
            </div>

            <div class="content-section">
                <h2>üîê Security & Privacy</h2>
                <p>Your data security is our priority:</p>
                <h3>Client-Side Processing</h3>
                <ul>
                    <li>‚úÖ All conversions happen in your browser</li>
                    <li>‚úÖ No file uploads to servers</li>
                    <li>‚úÖ Complete privacy and confidentiality</li>
                    <li>‚úÖ Works offline after initial load</li>
                </ul>

                <h3>No Data Collection</h3>
                <ul>
                    <li>üö´ We don't store your PDFs</li>
                    <li>üö´ No tracking of your documents</li>
                    <li>üö´ No third-party data sharing</li>
                    <li>üö´ Files deleted from memory after download</li>
                </ul>
            </div>

            <div class="content-section">
                <h2>‚ùì Frequently Asked Questions</h2>
                <div class="faq-item">
                    <div class="faq-question">Q: What types of PDFs can I convert?</div>
                    <div class="faq-answer">A: Any PDF containing tables with structured data. Reports, invoices, financial statements, and data tables work best.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">Q: Will formulas be preserved?</div>
                    <div class="faq-answer">A: No, PDF formulas are converted to static values. You'll need to recreate formulas in Excel.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">Q: Can I convert scanned PDFs?</div>
                    <div class="faq-answer">A: Scanned PDFs need OCR (Optical Character Recognition) processing first to extract text from images.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">Q: How accurate is the conversion?</div>
                    <div class="faq-answer">A: Very accurate for well-structured tables. Complex layouts may need minor adjustments after conversion.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">Q: Is there a file size limit?</div>
                    <div class="faq-answer">A: Yes, 50MB maximum. Most business documents are well under this limit.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">Q: Can I convert password-protected PDFs?</div>
                    <div class="faq-answer">A: You'll need to unlock the PDF first using a password removal tool.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">Q: What Excel format is the output?</div>
                    <div class="faq-answer">A: XLSX format, compatible with Excel 2007 and later, Google Sheets, and LibreOffice Calc.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">Q: How many tables can I convert?</div>
                    <div class="faq-answer">A: All tables in your PDF will be converted. Each page typically creates a new Excel sheet.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">Q: Do I need to install software?</div>
                    <div class="faq-answer">A: No! ZapTools works entirely in your browser. No downloads or installations required.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">Q: Is there a usage limit?</div>
                    <div class="faq-answer">A: No limits! Convert as many PDFs as you need, completely free, forever.</div>
                </div>
            </div>

            <div class="content-section">
                <h2>üîó Related PDF Tools</h2>
                <p>Explore our complete suite of free PDF tools:</p>
                <div class="feature-grid" style="margin-top: 2rem;">
                    <div class="feature-card" onclick="window.location.href='PDFtoWord.html'" style="cursor: pointer;">
                        <div class="feature-icon">üìù</div>
                        <h3>PDF to Word</h3>
                        <p>Convert PDF documents to editable Word files</p>
                    </div>
                    <div class="feature-card" onclick="window.location.href='PDFtoImage.html'" style="cursor: pointer;">
                        <div class="feature-icon">üñºÔ∏è</div>
                        <h3>PDF to Image</h3>
                        <p>Extract pages as high-quality images</p>
                    </div>
                    <div class="feature-card" onclick="window.location.href='SplitPDF.html'" style="cursor: pointer;">
                        <div class="feature-icon">‚úÇÔ∏è</div>
                        <h3>Split PDF</h3>
                        <p>Extract specific pages or divide PDF files</p>
                    </div>
                    <div class="feature-card" onclick="window.location.href='MergePDFs.html'" style="cursor: pointer;">
                        <div class="feature-icon">üìë</div>
                        <h3>Merge PDFs</h3>
                        <p>Combine multiple PDF files into one</p>
                    </div>
                </div>
            </div>

            <div class="ad-container">
                <div class="ad-label">Advertisement</div>
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6389544196145251" data-ad-slot="3131107512" data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>
        </div>

        <div class="sidebar-ad">
            <div class="ad-container">
                <div class="ad-label">Ad</div>
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6389544196145251" data-ad-slot="3131107512" data-ad-format="vertical"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>
        </div>
    </div>

    <div class="file-history-widget collapsed" id="historyWidget">
        <div class="history-header" onclick="document.getElementById('historyWidget').classList.toggle('collapsed')">
            <div class="history-title">
                <span>üìã</span>
                <span>Recent Files</span>
            </div>
            <div class="history-toggle">‚ñº</div>
        </div>
        <div class="history-content" id="fileHistory">
            <div class="history-empty">No recent files</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        const langData = {
            vi: {
                title: 'PDF sang Excel Mi·ªÖn Ph√≠ - Chuy·ªÉn B·∫£ng PDF sang Spreadsheet',
                subtitle: 'Tr√≠ch xu·∫•t b·∫£ng t·ª´ PDF v√† chuy·ªÉn sang file Excel c√≥ th·ªÉ ch·ªânh s·ª≠a. Nhanh, ch√≠nh x√°c, ho√†n to√†n mi·ªÖn ph√≠!',
                fileLabel: 'üìÑ Ch·ªçn File PDF:',
                convertBtn: 'üìä Chuy·ªÉn sang Excel Ngay',
                processing: 'ƒêang x·ª≠ l√Ω... Vui l√≤ng ƒë·ª£i',
                success: 'Chuy·ªÉn ƒë·ªïi th√†nh c√¥ng! ƒêang t·∫£i xu·ªëng...',
                error: 'L·ªói: ',
                back: '‚Üê Quay l·∫°i PDF Tools',
                instructionsTitle: 'üìã H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng:',
                instructions: [
                    '<strong>‚≠ê Khuy√™n d√πng cho PDF ph·ª©c t·∫°p:</strong> M·ªü b·∫±ng <a href="#wordGuideDetail" style="color: #667eea; text-decoration: underline; font-weight: bold;">Microsoft Word (2016+)</a> ‚Üí Copy b·∫£ng ‚Üí Paste v√†o Excel (ƒê·ªô ch√≠nh x√°c 95-99%)',
                    '<strong>PDF ƒë∆°n gi·∫£n:</strong> Tool n√†y t·ª± ƒë·ªông chuy·ªÉn PDF text sang Excel',
                    '<strong>PDF scan:</strong> Tool s·∫Ω t·ª± ƒë·ªông ph√°t hi·ªán v√† b·∫≠t OCR (Ti·∫øng Vi·ªát, English - gi·ªõi h·∫°n 5 trang)',
                    '<strong>‚ö†Ô∏è L∆∞u √Ω:</strong> PDF c√≥ b·∫£ng ph·ª©c t·∫°p (merge cells, nhi·ªÅu c·ªôt) ‚Üí K·∫øt qu·∫£ c√≥ th·ªÉ sai format ‚Üí <a href="#wordGuideDetail" style="color: #667eea; text-decoration: underline;">Xem h∆∞·ªõng d·∫´n d√πng Word b√™n d∆∞·ªõi</a>',
                    'K√≠ch th∆∞·ªõc: <strong>50MB</strong> | S·ªë trang: <strong>50 trang</strong> (text) / <strong>5 trang</strong> (OCR)'
                ]
            },
            en: {
                title: 'PDF to Excel Free - Convert PDF Tables to Spreadsheets',
                subtitle: 'Extract tables from PDFs and convert to editable Excel files. Fast, accurate, and completely free!',
                fileLabel: 'üìÑ Select PDF File:',
                convertBtn: 'üìä Convert to Excel Now',
                processing: 'Processing... Please wait',
                success: 'Conversion successful! Downloading...',
                error: 'Error: ',
                back: '‚Üê Back to PDF Tools',
                instructionsTitle: 'üìã How to Use:',
                instructions: [
                    '<strong>‚≠ê Recommended for complex PDFs:</strong> Open with <a href="#wordGuideDetail" style="color: #667eea; text-decoration: underline; font-weight: bold;">Microsoft Word (2016+)</a> ‚Üí Copy table ‚Üí Paste to Excel (95-99% accuracy)',
                    '<strong>Simple PDFs:</strong> This tool auto-converts text PDFs to Excel',
                    '<strong>Scanned PDFs:</strong> Auto-detects and enables OCR (Vietnamese, English - 5 pages limit)',
                    '<strong>‚ö†Ô∏è Note:</strong> Complex tables (merged cells, multi-columns) ‚Üí May have format issues ‚Üí <a href="#wordGuideDetail" style="color: #667eea; text-decoration: underline;">See Word guide below</a>',
                    'Size: <strong>50MB</strong> | Pages: <strong>50 pages</strong> (text) / <strong>5 pages</strong> (OCR)'
                ]
            }
        };

        function setLang(lang) {
            document.getElementById('title').textContent = langData[lang].title;
            document.getElementById('subtitle').textContent = langData[lang].subtitle;
            document.getElementById('fileLabel').textContent = langData[lang].fileLabel;
            document.getElementById('convertBtn').innerHTML = langData[lang].convertBtn;
            document.getElementById('instructionsTitle').textContent = langData[lang].instructionsTitle;
            document.getElementById('instructionsList').innerHTML = langData[lang].instructions.map(item => `<li>${item}</li>`).join('');
        }

        document.getElementById('langSwitcher').addEventListener('change', function(e) {
            setLang(e.target.value);
            localStorage.setItem('zaptools_lang', e.target.value);
        });

        const savedLang = localStorage.getItem('zaptools_lang') || 'vi';
        document.getElementById('langSwitcher').value = savedLang;
        setLang(savedLang);

        async function convertPDFtoExcel(file) {
            const resultDiv = document.getElementById('result');
            const submitBtn = document.getElementById('convertBtn');

            try {
                // Show processing message
                resultDiv.textContent = langData[savedLang].processing;
                resultDiv.className = 'success';
                submitBtn.disabled = true;
                submitBtn.style.opacity = '0.5';

                // Read PDF file
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                const numPages = pdf.numPages;

                // Check limits
                if (numPages > 50) {
                    throw new Error('PDF has too many pages (max 50)');
                }

                // Create workbook
                const workbook = XLSX.utils.book_new();
                let totalTextItems = 0;

                // Process each page
                for (let pageNum = 1; pageNum <= numPages; pageNum++) {
                    resultDiv.textContent = `${langData[savedLang].processing} (${pageNum}/${numPages})`;

                    const page = await pdf.getPage(pageNum);
                    const textContent = await page.getTextContent();

                    // Extract text items
                    const items = textContent.items;
                    totalTextItems += items.length;

                    if (items.length === 0) {
                        // Empty page - might be scanned PDF
                        const warningData = savedLang === 'vi' ? [
                            ['‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y text tr√™n trang n√†y'],
                            ['ƒê√¢y c√≥ th·ªÉ l√† PDF scan (d·∫°ng h√¨nh ·∫£nh)'],
                            ['Vui l√≤ng d√πng c√¥ng c·ª• OCR ƒë·ªÉ tr√≠ch xu·∫•t text tr∆∞·ªõc'],
                            ['Ho·∫∑c th·ª≠ c√¥ng c·ª• PDF to Image c·ªßa ch√∫ng t√¥i']
                        ] : [
                            ['‚ö†Ô∏è No text found on this page'],
                            ['This might be a scanned PDF (image-based)'],
                            ['Please use OCR tool first to extract text'],
                            ['Or try our PDF to Image tool instead']
                        ];
                        const worksheet = XLSX.utils.aoa_to_sheet(warningData);
                        XLSX.utils.book_append_sheet(workbook, worksheet, `Page ${pageNum}`);
                        continue;
                    }

                    // Group items by Y position (rows) with tolerance
                    const tolerance = 5; // pixels tolerance for same row
                    const rows = {};

                    items.forEach(item => {
                        if (!item.str || item.str.trim() === '') return; // Skip empty items

                        const y = Math.round(item.transform[5]);
                        const x = Math.round(item.transform[4]);

                        // Find existing row within tolerance
                        let foundRow = null;
                        for (let existingY in rows) {
                            if (Math.abs(existingY - y) <= tolerance) {
                                foundRow = existingY;
                                break;
                            }
                        }

                        const rowKey = foundRow || y;
                        if (!rows[rowKey]) rows[rowKey] = [];
                        rows[rowKey].push({
                            text: item.str.trim(),
                            x: x,
                            width: item.width
                        });
                    });

                    // Sort rows by Y position (top to bottom)
                    const sortedYPositions = Object.keys(rows).map(y => parseInt(y)).sort((a, b) => b - a);

                    // Create worksheet data with better column detection
                    const wsData = [];
                    const allXPositions = new Set();

                    // Collect all X positions to determine column structure
                    sortedYPositions.forEach(y => {
                        rows[y].forEach(item => {
                            allXPositions.add(item.x);
                        });
                    });

                    // Sort X positions to create column boundaries
                    const sortedXPositions = Array.from(allXPositions).sort((a, b) => a - b);

                    // Create column boundaries with tolerance
                    const colTolerance = 20;
                    const columns = [];
                    sortedXPositions.forEach(x => {
                        if (columns.length === 0 || x - columns[columns.length - 1] > colTolerance) {
                            columns.push(x);
                        }
                    });

                    // Process each row
                    sortedYPositions.forEach(y => {
                        const rowItems = rows[y].sort((a, b) => a.x - b.x);
                        const rowData = new Array(columns.length).fill('');

                        rowItems.forEach(item => {
                            // Find which column this item belongs to
                            let colIdx = 0;
                            for (let i = 0; i < columns.length; i++) {
                                if (Math.abs(item.x - columns[i]) <= colTolerance) {
                                    colIdx = i;
                                    break;
                                }
                            }

                            // Concatenate if cell already has content
                            if (rowData[colIdx]) {
                                rowData[colIdx] += ' ' + item.text;
                            } else {
                                rowData[colIdx] = item.text;
                            }
                        });

                        // Only add non-empty rows
                        if (rowData.some(cell => cell !== '')) {
                            wsData.push(rowData);
                        }
                    });

                    // If no data extracted, add a message
                    if (wsData.length === 0) {
                        wsData.push(['No data could be extracted from this page']);
                    }

                    // Create worksheet
                    const worksheet = XLSX.utils.aoa_to_sheet(wsData);

                    // Auto-size columns based on content
                    const colWidths = [];
                    wsData.forEach(row => {
                        row.forEach((cell, colIdx) => {
                            const cellLen = cell ? cell.toString().length : 10;
                            if (!colWidths[colIdx] || colWidths[colIdx] < cellLen) {
                                colWidths[colIdx] = cellLen;
                            }
                        });
                    });
                    worksheet['!cols'] = colWidths.map(w => ({ wch: Math.min(Math.max(w + 2, 10), 50) }));

                    // Add worksheet to workbook
                    const sheetName = `Page ${pageNum}`;
                    XLSX.utils.book_append_sheet(workbook, worksheet, sheetName);
                }

                // Check if PDF had any text
                if (totalTextItems === 0) {
                    const warningMsg = savedLang === 'vi'
                        ? '‚ö†Ô∏è PDF n√†y kh√¥ng c√≥ text! ƒê√¢y l√† PDF scan (h√¨nh ·∫£nh). Vui l√≤ng d√πng c√¥ng c·ª• OCR tr∆∞·ªõc ho·∫∑c th·ª≠ PDF to Image.'
                        : '‚ö†Ô∏è This PDF contains no text! It\'s a scanned PDF (image). Please use OCR tool first or try PDF to Image.';
                    throw new Error(warningMsg);
                }

                // Generate Excel file
                const excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });
                const blob = new Blob([excelBuffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });

                // Download file
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = file.name.replace('.pdf', '') + '.xlsx';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                // Show success message
                resultDiv.textContent = langData[savedLang].success;
                resultDiv.className = 'success';

                // Add to file history
                const fileHistory = JSON.parse(localStorage.getItem('zaptools_file_history') || '[]');
                fileHistory.unshift({
                    name: file.name,
                    date: new Date().toLocaleString()
                });
                if (fileHistory.length > 10) fileHistory.pop();
                localStorage.setItem('zaptools_file_history', JSON.stringify(fileHistory));
                updateHistoryDisplay();

                // Log usage
                if (typeof logToolUsage === 'function') {
                    logToolUsage('PDFtoExcel');
                }

            } catch (error) {
                resultDiv.textContent = langData[savedLang].error + error.message;
                resultDiv.className = 'error';
            } finally {
                submitBtn.disabled = false;
                submitBtn.style.opacity = '1';
            }
        }

        // OCR function
        async function performOCRAndConvert(file) {
            const resultDiv = document.getElementById('result');
            const ocrBtn = document.getElementById('ocrBtn');
            const ocrLanguage = document.getElementById('ocrLanguage').value;

            try {
                ocrBtn.disabled = true;
                ocrBtn.style.opacity = '0.5';

                resultDiv.textContent = savedLang === 'vi' ? 'üîç ƒêang OCR... Vui l√≤ng ƒë·ª£i (c√≥ th·ªÉ m·∫•t v√†i ph√∫t)' : 'üîç OCR in progress... Please wait (may take a few minutes)';
                resultDiv.className = 'info';

                // Read PDF
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                const numPages = Math.min(pdf.numPages, 5); // Limit to 5 pages for OCR

                let allText = '';

                for (let pageNum = 1; pageNum <= numPages; pageNum++) {
                    resultDiv.textContent = savedLang === 'vi'
                        ? `üîç ƒêang OCR trang ${pageNum}/${numPages}...`
                        : `üîç OCR page ${pageNum}/${numPages}...`;

                    const page = await pdf.getPage(pageNum);
                    const viewport = page.getViewport({ scale: 2.0 });

                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.width = viewport.width;
                    canvas.height = viewport.height;

                    await page.render({ canvasContext: context, viewport: viewport }).promise;

                    const { data: { text } } = await Tesseract.recognize(
                        canvas,
                        ocrLanguage,
                        { logger: () => {} }
                    );

                    allText += text + '\n\n';
                }

                // Create Excel with OCR text - parse into structured data
                const workbook = XLSX.utils.book_new();
                const lines = allText.split('\n').filter(line => line.trim() !== '');

                // Try to detect key-value pairs and structure
                const wsData = [];
                lines.forEach(line => {
                    line = line.trim();
                    if (!line) return;

                    // Try to split by common separators: : or multiple spaces
                    if (line.includes(':')) {
                        const parts = line.split(':').map(p => p.trim());
                        if (parts.length === 2) {
                            wsData.push(parts);
                        } else if (parts.length > 2) {
                            // Multiple colons, group first part as key
                            wsData.push([parts[0], parts.slice(1).join(':')]);
                        } else {
                            wsData.push([line]);
                        }
                    } else if (line.match(/\s{3,}/)) {
                        // Multiple spaces might indicate columns
                        const parts = line.split(/\s{3,}/).map(p => p.trim()).filter(p => p);
                        wsData.push(parts);
                    } else {
                        // Single column data
                        wsData.push([line]);
                    }
                });

                const worksheet = XLSX.utils.aoa_to_sheet(wsData);

                // Auto-size columns
                const maxLengths = [];
                wsData.forEach(row => {
                    row.forEach((cell, idx) => {
                        const len = cell ? cell.toString().length : 0;
                        maxLengths[idx] = Math.max(maxLengths[idx] || 0, len);
                    });
                });
                worksheet['!cols'] = maxLengths.map(len => ({ wch: Math.min(Math.max(len + 2, 15), 80) }));

                XLSX.utils.book_append_sheet(workbook, worksheet, 'OCR Text');

                // Generate Excel file
                const excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });
                const blob = new Blob([excelBuffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });

                // Download file
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = file.name.replace('.pdf', '') + '_OCR.xlsx';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                resultDiv.textContent = savedLang === 'vi' ? '‚úÖ OCR th√†nh c√¥ng! File Excel ƒë√£ t·∫£i xu·ªëng.' : '‚úÖ OCR successful! Excel file downloaded.';
                resultDiv.className = 'success';

                if (typeof logToolUsage === 'function') {
                    logToolUsage('PDFtoExcel_OCR');
                }

            } catch (error) {
                resultDiv.textContent = langData[savedLang].error + error.message;
                resultDiv.className = 'error';
            } finally {
                ocrBtn.disabled = false;
                ocrBtn.style.opacity = '1';
            }
        }

        // Check if PDF has text on file selection
        document.getElementById('pdfFile').addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (!file) return;

            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;

                if (pdf.numPages > 0) {
                    const page = await pdf.getPage(1);
                    const textContent = await page.getTextContent();

                    if (textContent.items.length === 0) {
                        // No text found - probably scanned PDF
                        document.getElementById('ocrOptions').style.display = 'block';
                        document.getElementById('convertBtn').style.display = 'none';
                        document.getElementById('ocrBtn').style.display = 'block';

                        const resultDiv = document.getElementById('result');
                        resultDiv.textContent = savedLang === 'vi'
                            ? '‚ö†Ô∏è PDF scan ph√°t hi·ªán! Vui l√≤ng ch·ªçn ng√¥n ng·ªØ v√† nh·∫•n OCR.'
                            : '‚ö†Ô∏è Scanned PDF detected! Please select language and click OCR.';
                        resultDiv.className = 'info';
                    } else {
                        // Has text - normal conversion
                        document.getElementById('ocrOptions').style.display = 'none';
                        document.getElementById('convertBtn').style.display = 'block';
                        document.getElementById('ocrBtn').style.display = 'none';
                        document.getElementById('result').style.display = 'none';
                    }
                }
            } catch (error) {
                console.error('Error checking PDF:', error);
            }
        });

        document.getElementById('ocrBtn').addEventListener('click', function() {
            const fileInput = document.getElementById('pdfFile');
            const file = fileInput.files[0];
            if (file) {
                performOCRAndConvert(file);
            }
        });

        document.getElementById('pdfForm').onsubmit = function(e) {
            e.preventDefault();
            const fileInput = document.getElementById('pdfFile');
            const file = fileInput.files[0];

            if (!file) {
                const resultDiv = document.getElementById('result');
                resultDiv.textContent = savedLang === 'vi' ? 'Vui l√≤ng ch·ªçn file PDF!' : 'Please select a PDF file!';
                resultDiv.className = 'error';
                return;
            }

            if (file.size > 50 * 1024 * 1024) {
                const resultDiv = document.getElementById('result');
                resultDiv.textContent = savedLang === 'vi' ? 'File qu√° l·ªõn! (T·ªëi ƒëa 50MB)' : 'File too large! (Max 50MB)';
                resultDiv.className = 'error';
                return;
            }

            convertPDFtoExcel(file);
        };

        const fileHistory = JSON.parse(localStorage.getItem('zaptools_file_history') || '[]');
        function updateHistoryDisplay() {
            const historyContent = document.getElementById('fileHistory');
            if (fileHistory.length === 0) {
                historyContent.innerHTML = '<div class="history-empty">No recent files</div>';
            } else {
                historyContent.innerHTML = fileHistory.map(file => `<div style="padding: 0.5rem; border-bottom: 1px solid #eee;"><div style="font-weight: 600; color: #667eea;">${file.name}</div><div style="font-size: 0.8rem; color: #999;">${file.date}</div></div>`).join('');
            }
        }
        updateHistoryDisplay();
    </script>
    <script src="tool-usage-logger.js"></script>
</body>
</html>